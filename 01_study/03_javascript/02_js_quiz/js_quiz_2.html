<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>JS Quiz</title>
    <link rel="stylesheet" href="../../../css/font.css">
    <link rel="stylesheet" href="../../../css/child_style.css">
    <style>
        progress, .progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 16px
        }

        .progress_bar {
            width: 100%;
            height: 100%;
            background-color: #ddd
        }

        .wrap {
            padding-top: 20px
        }
    </style>
</head>
<body>
<div id="wrap">
    <progress value="0" max="10"></progress>
    <div class="explain">
        <h1 class="tit">설명</h1>
        <dl>
            <dt class="d_tit">조건</dt>
            <dd class="d_txt">IE8까지 지원</dd>
            <dd class="d_txt">only javascript만 활용</dd>
            <dt class="d_tit">기법</dt>
            <dd class="d_txt">progress tag 지원범위 IE10+
                <ul class="lst">
                    <li class="item">IE8, IE9에선 대체 태그 생성 및 입력</li>
                </ul>
            </dd>
            <dt class="d_tit">한계</dt>
            <dd class="d_txt">IE8과 IE9에서 대체 tag가 들어갈 때 css도 js로 넣고 싶었으나 뜻대로 되지 않음 (CSS에 IE8,9 대비용 CSS 작성)
                <ul class="lst">
                    <li class="item">이 부분은 다시 해결해봐야되는 부분</li>
                </ul>
            </dd>
            <dd class="d_txt">아이폰 X에서 테스트시 상하단바가 스크롤시 없어진 상태일 때 프로그래스바가 전부 채워지지 않는 현상 발생
                <ul class="lst">
                    <li class="item">다시 스크롤해서 상하단바가 생기면 스크롤바가 100% 채워짐</li>
                    <li class="item">이는 아이폰X에서만 생기는 현상인듯, notch 영역 때문인거 같음</li>
                </ul>
            </dd>
        </dl>
    </div>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
    <p>Schauer das aus sage was und, hinweggeschwunden fühlt den labyrinthisch welt sich tränen ich ihr, diesmal wird
        die meinem unbekannten, steigen der nennt ein fühlt und gestalten, bang lauf tage ich mein. Wird ernsten einer
        lispelnd und ihr, alten nach die nun ein. Ihr ist wenn in ersten getäuscht bringt.</p>
</div>
<script>
    /*
    페이지 스크롤시 상단 프로그래스 바채워지게.
    움직인 만큼 채워지면 됩니다.

    스크롤의 높이.
    문서의 높이.
    스크롤이벤트.
    프로그래스 value 값이 100이면 꽉참.
    그럼..스크롤이 움직이는 총 길이가 100이 되어야 겠죠~ 백분율...

    IE8+
    IE8 대비용 스타일 추가
    */

    function has3d() {
        if (!window.getComputedStyle) {
            return false;
        }
        var el = document.createElement('p'),
            has3d,
            transforms = {
                'webkitTransform': '-webkit-transform',
                'OTransform': '-o-transform',
                'msTransform': '-ms-transform',
                'MozTransform': '-moz-transform',
                'transform': 'transform'
            };
        // Add it to the body to get the computed style.
        document.body.insertBefore(el, null);
        for (var t in transforms) {
            if (el.style[t] !== undefined) {
                el.style[t] = "translate3d(1px,1px,1px)";
                has3d = window.getComputedStyle(el).getPropertyValue(transforms[t]);
            }
        }
        document.body.removeChild(el);
        var val = (has3d !== undefined && has3d.length > 0 && has3d !== "none") ? true : "IE9";
        return val;
    }

    var getElementsByClassNameCompatible = function (className) {
        if (document.getElementsByClassName) {
            return document.getElementsByClassName(className);
        }
        var regEx = new RegExp('(^| )' + className + '( |$)');
        var nodes = new Array();
        var elements = document.body.getElementsByTagName("*");
        var len = elements.length;
        for (var i = 0; i < len; i++) {
            if (regEx.test(elements[i].className)) {
                nodes.push(elements[i]);
            }
        }
        elements = null;
        return nodes;
    };

    var x = document.getElementsByTagName("progress"),
        wrap = getElementsByClassNameCompatible("wrap"),
        winScroll = document.body.scrollTop || document.documentElement.scrollTop,
        height = document.documentElement.scrollHeight - document.documentElement.clientHeight,
        scrolled,
        max = x[0].max,
        progress,
        progressBar;

    if (x[0].scopeName) {
        x[0].parentNode.removeChild(x[0]);
        progress = document.createElement("DIV"),
            progressBar = document.createElement("DIV");

        progress.className = "progress";
        progressBar.className = "progress_bar";
        progress.appendChild(progressBar);
        wrap[0].insertBefore(progress, wrap[0].childNodes[0]);

        if (has3d() == "IE9") {
            progressBar.style.msTransform = "translate(-100%,0)";
        } else if (!has3d()) {
            progressBar.style.width = "0%";
        }
    }

    if (window.addEventListener) {
        window.addEventListener('scroll', function () {
            if (has3d() == true) {
                winScroll = document.body.scrollTop || document.documentElement.scrollTop,
                    height = document.documentElement.scrollHeight - document.documentElement.clientHeight,
                    scrolled = winScroll / height * max;
                x[0].value = scrolled;
            } else if (has3d() == "IE9") {
                winScroll = document.body.scrollTop || document.documentElement.scrollTop,
                    height = document.documentElement.scrollHeight - document.documentElement.clientHeight,
                    scrolled = 100 - (winScroll / height * 100);
                progressBar.style.msTransform = "translate(-" + scrolled + "%,0)";
            }
        })
    } else if (window.attachEvent) {
        window.onscroll = function () {
            winScroll = document.body.scrollTop || document.documentElement.scrollTop,
                height = document.documentElement.scrollHeight - document.documentElement.clientHeight,
                scrolled = winScroll / height * 100;
            progressBar.style.width = scrolled + "%";
        }
    }
</script>
</body>
</html>
